(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-557e569c"],{"5c8a":function(e,t,a){},cfa1:function(e,t,a){"use strict";a("5c8a")},fcc9:function(e,t,a){"use strict";a.r(t);var n=a("7a23");const l={class:"role-container"},c={class:"wrapper"},r={class:"content-box"},o=["onClick"],i={class:"role-tree-box"},d={key:0},s={style:{color:"#f50"}},u={key:1};function h(e,t,a,h,p,b){const O=Object(n["resolveComponent"])("a-table"),j=Object(n["resolveComponent"])("a-input-search"),v=Object(n["resolveComponent"])("a-tree"),m=Object(n["resolveComponent"])("a-modal");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",l,[Object(n["createElementVNode"])("div",c,[Object(n["createElementVNode"])("div",r,[Object(n["createVNode"])(O,{bordered:"",dataSource:h.roleData,columns:h.columns,size:"small",pagination:h.pagination,loading:h.loading},{operation:Object(n["withCtx"])(({record:e})=>[Object(n["createElementVNode"])("a",{onClick:t=>h.handleAllotAuth(e)},"分配权限",8,o)]),_:1},8,["dataSource","columns","pagination","loading"])])]),Object(n["createVNode"])(m,{title:h.modalTitle,visible:h.visible,"onUpdate:visible":t[3]||(t[3]=e=>h.visible=e),"confirm-loading":h.confirmLoading,cancelText:"取消",okText:"保存",maskClosable:!1,onOk:h.handleOk,onCancel:h.handleCancel},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",i,[Object(n["createVNode"])(j,{value:h.searchTreeValue,"onUpdate:value":t[0]||(t[0]=e=>h.searchTreeValue=e),style:{"margin-bottom":"8px"},placeholder:"搜索权限"},null,8,["value"]),Object(n["createVNode"])(v,{"tree-data":h.treeData,autoExpandParent:h.autoExpandParent,expandedKeys:h.expandedKeys,"onUpdate:expandedKeys":t[1]||(t[1]=e=>h.expandedKeys=e),checkedKeys:h.checkedKeys,"onUpdate:checkedKeys":t[2]||(t[2]=e=>h.checkedKeys=e),onExpand:h.handleTreeExpand,onCheck:h.handleTreeCheck,checkable:"",selectable:!1},{title:Object(n["withCtx"])(({title:e})=>[e.indexOf(h.searchTreeValue)>-1?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",d,[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.substr(0,e.indexOf(h.searchTreeValue)))+" ",1),Object(n["createElementVNode"])("span",s,Object(n["toDisplayString"])(h.searchTreeValue),1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.substr(e.indexOf(h.searchTreeValue)+h.searchTreeValue.length)),1)])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",u,Object(n["toDisplayString"])(e),1))]),_:1},8,["tree-data","autoExpandParent","expandedKeys","checkedKeys","onExpand","onCheck"])])]),_:1},8,["title","visible","confirm-loading","onOk","onCancel"])])}a("14d9");var p=a("b775");function b(){return Object(p["a"])({url:"/jc-admin/roles",method:"get"})}var O={name:"RolePermissionList",setup(){const e=Object(n["ref"])(!1),t=Object(n["ref"])(!1),a=Object(n["ref"])(!1),l=Object(n["ref"])(""),c=Object(n["ref"])(""),r=Object(n["ref"])(!0),o=Object(n["ref"])([]),i=Object(n["ref"])([]),d=Object(n["ref"])([]),s=Object(n["ref"])([]),u=Object(n["reactive"])({total:0,size:"middle",defaultPageSize:20,current:1,pageSize:20,showSizeChanger:!0,showQuickJumper:!0,pageSizeOptions:["10","20","30"],showTotal:e=>`共有 ${e} 条数据`,onShowSizeChange:(e,t)=>u.pageSize=t,onChange:(e,t)=>u.current=e}),h=Object(n["ref"])([{title:"序号",dataIndex:"serial",width:60,align:"center",customRender:({t:e,r:t,index:a})=>""+((u.current-1)*u.pageSize+parseInt(a)+1)},{title:"角色名",dataIndex:"name",width:120},{title:"角色key",dataIndex:"key",width:120},{title:"描述",dataIndex:"description"},{title:"操作",dataIndex:"operation",slots:{customRender:"operation"}}]),p=()=>{e.value=!0,b().then(t=>{200===t.code&&setTimeout(()=>{s.value=t.data,u.total=t.data.length,e.value=!1},2e3)})},O=e=>{o.value=e,r.value=!1},j=(e,t)=>{e.value=e},v=e=>{t.value=!0,l.value="当前分配角色--"+e.name,d.value=f(e.routes),i.value=m(e.routes,[])},m=(e,t)=>{for(let a=0;a<e.length;a++){const n=e[a],{path:l}=n;t.push(l),n.children&&m(n.children,t)}return t},f=e=>{if(!Array.isArray(e)&&e.length<1)return;const t=[];return e.forEach(e=>{if(e.children&&e.children.length>0){const a=f(e.children);t.push({key:e.path,title:e.meta.title,children:a})}else t.push({key:e.path,title:e.meta.title})}),t},k=()=>{x()},g=()=>{x()},x=()=>{o.value=[],c.value="",t.value=!1,r.value=!1},y=(e,t)=>{let a;for(let n=0;n<t.length;n++){const l=t[n];l.children&&(l.children.some(t=>t.key===e)?a=l.key:y(e,l.children)&&(a=y(e,l.children)))}return a},C=(e,t)=>{for(let a=0;a<e.length;a++){const n=e[a],{key:l,title:c}=n;t.push({key:l,title:c}),n.children&&C(n.children,t)}return t};return Object(n["watch"])(c,e=>{if(!e)return void(o.value=[]);const t=C(d.value,[]),a=t.map(t=>t.title.indexOf(e)>-1?y(t.key,d.value):null).filter((e,t,a)=>e&&a.indexOf(e)===t);o.value=a,c.value=e,r.value=!0}),Object(n["onMounted"])(()=>{p()}),{roleData:s,columns:h,pagination:u,loading:e,visible:t,confirmLoading:a,modalTitle:l,treeData:d,searchTreeValue:c,expandedKeys:o,checkedKeys:i,autoExpandParent:r,handleTreeExpand:O,handleTreeCheck:j,handleOk:k,handleCancel:g,getRoleData:p,handleAllotAuth:v}}},j=(a("cfa1"),a("d959")),v=a.n(j);const m=v()(O,[["render",h],["__scopeId","data-v-f2b38b5e"]]);t["default"]=m}}]);